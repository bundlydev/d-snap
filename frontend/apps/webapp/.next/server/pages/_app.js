(()=>{var t={};t.id=888,t.ids=[888],t.modules={9188:(t,e,r)=>{"use strict";r.d(e,{v:()=>h});var i={};r.r(i),r.d(i,{canisterId:()=>s,createActor:()=>o,idlFactory:()=>c});var n={};r.r(n),r.d(n,{canisterId:()=>d,createActor:()=>l,idlFactory:()=>u});var a=r(4515);let c=({IDL:t})=>t.Service({greet:t.Func([t.Text],[t.Text],["query"])}),s=process.env.CANISTER_ID_TEST||"bd3sg-teaaa-aaaaa-qaaba-cai",o=(t,e={})=>{let r=e.agent||new a.HttpAgent({...e.agentOptions});return e.agent&&e.agentOptions&&console.warn("Detected both agent and agentOptions passed to createActor. Ignoring agentOptions and proceeding with the provided agent."),r.fetchRootKey().catch(t=>{console.warn("Unable to fetch root key. Check to ensure that your local replica is running"),console.error(t)}),a.Actor.createActor(c,{agent:r,canisterId:t,...e.actorOptions})},u=({IDL:t})=>{let e=t.Variant({jpg:t.Null,jpeg:t.Null}),r=t.Record({url:t.Text,encoding:t.Text,blob:t.Vec(t.Nat8),name:t.Text,size:t.Nat,mimetype:e}),i=t.Record({day:t.Nat8,month:t.Nat8,year:t.Nat8}),n=t.Record({bio:t.Text,username:t.Text,picture:r,birthday:i}),a=t.Variant({userNotAuthenticated:t.Null,userAlreadyExists:t.Null}),c=t.Variant({ok:t.Null,err:a}),s=t.Record({description:t.Text,images:t.Vec(r)}),o=t.Variant({userNotFound:t.Null,userNotAuthenticated:t.Null}),u=t.Variant({ok:t.Null,err:o}),d=t.Record({to:t.Int,from:t.Int}),l=t.Record({userId:t.Principal,createdAt:t.Int}),h=t.Record({id:t.Principal,linkedComment:t.Opt(t.Principal),userId:t.Principal,createdAt:t.Int,likes:t.Vec(l),comment:t.Text}),p=t.Record({id:t.Text,createdAt:t.Int,description:t.Text,likes:t.Vec(t.Principal),updatedAt:t.Int,comments:t.Vec(h),images:t.Vec(r)}),g=t.Record({data:t.Vec(t.Tuple(t.Text,p))}),y=t.Variant({userNotFound:t.Null,userNotAuthenticated:t.Null}),f=t.Variant({ok:g,err:y}),m=t.Record({bio:t.Text,username:t.Text,createdAt:t.Int,picture:r,birthday:i}),w=t.Variant({userNotFound:t.Null,userNotAuthenticated:t.Null}),A=t.Variant({ok:m,err:w});return t.Service({create:t.Func([n],[c],[]),createPost:t.Func([s],[u],[]),getPosts:t.Func([d],[f],["composite_query"]),getProfile:t.Func([],[A],["composite_query"])})},d=process.env.CANISTER_ID_USER||"be2us-64aaa-aaaaa-qaabq-cai",l=(t,e={})=>{let r=e.agent||new a.HttpAgent({...e.agentOptions});return e.agent&&e.agentOptions&&console.warn("Detected both agent and agentOptions passed to createActor. Ignoring agentOptions and proceeding with the provided agent."),r.fetchRootKey().catch(t=>{console.warn("Unable to fetch root key. Check to ensure that your local replica is running"),console.error(t)}),a.Actor.createActor(u,{agent:r,canisterId:t,...e.actorOptions})},h={test:i,user:n}},9401:(t,e,r)=>{"use strict";r.a(t,async(t,i)=>{try{r.d(e,{H:()=>h,V:()=>l});var n=r(997),a=r(3359),c=r(6689),s=r(9926),o=t([s]);let u=(s=(o.then?(await o)():o)[0]).default.object({bio:s.default.string(),username:s.default.string(),picture:s.default.object({url:s.default.string()}),createdAt:s.default.bigint()}),d=s.default.object({ok:u,err:s.default.string().optional()}),l=(0,c.createContext)({}),h=({children:t})=>{let{connect:e,disconnect:r}=(0,a.aC)(),i=(0,a.Lm)("user"),[s,o]=(0,c.useState)(!1),[u,h]=(0,c.useState)();async function p(){if(s)try{let t=await i.getProfile(),e=d.safeParse(t);if(!e.success)throw Error("Invalid response");if(e.success&&"err"in e.data)return;let r={username:e.data?.ok.username,bio:e.data?.ok.bio,picture:e.data?.ok.picture,createdAt:e.data?.ok.createdAt};h(r)}catch(t){throw t}else h(void 0)}async function g(){try{await e(),o(!0)}catch(t){throw t}}async function y(){await r(),o(!1)}return(0,c.useEffect)(()=>{p()},[s]),n.jsx(l.Provider,{value:{isAuth:s,profile:u,login:g,logout:y},children:t})};i()}catch(t){i(t)}})},4619:(t,e,r)=>{"use strict";r.a(t,async(t,i)=>{try{r.r(e),r.d(e,{default:()=>h});var n=r(997);r(9724);var a=r(9401),c=r(9188),s=r(1417),o=r(8538),u=r(3051),d=r(6689),l=t([a]);function h({Component:t,pageProps:e}){let[r,i]=(0,d.useState)();async function l(){let t=new o.w({providerUrl:"http://127.0.0.1:4943/?canisterId=bkyz2-fmaaa-aaaaa-qaaaq-cai"}),e=await s.K.create({host:"http://localhost:4943",canisters:c.v,providers:{"internet-identity":t}});i(e)}return(0,d.useEffect)(()=>{l()},[]),r?n.jsx(u.b,{client:r,children:n.jsx(a.H,{children:n.jsx(t,{...e})})}):n.jsx("div",{children:"Loading"})}a=(l.then?(await l)():l)[0],i()}catch(t){i(t)}})},1417:(t,e,r)=>{"use strict";r.d(e,{K:()=>n});var i=r(4515);class n{constructor(t,e,r){this.agent=t,this._canisters=e,this.providers=r,this.actors={},this.init()}init(){this.agent.fetchRootKey().then(t=>{console.warn("Unable to fetch root key. Check to ensure that your local replica is running")}),this.setActors()}setIdentity(t){t?this.agent.replaceIdentity(t):this.agent.invalidateIdentity(),this.setActors()}setActors(){let t=Object.entries(this._canisters).reduce((t,e)=>{let[r,n]=e,{idlFactory:a,canisterId:c,configuration:s={}}=n,o=i.Actor.createActor(a,{agent:this.agent,canisterId:c,...s});return{...t,[r]:o}},{});this.actors=t}getActor(t){return this.actors[t]}getProviders(){return this.providers}static async create(t){let{host:e,canisters:r,providers:a}=t;return Object.keys(a).forEach(async t=>{await a[t].init()}),new n(new i.HttpAgent({host:e,verifyQuerySignatures:!1}),r,a)}}},8538:(t,e,r)=>{"use strict";r.d(e,{w:()=>a});var i=r(5088);let n={providerUrl:"https://identity.ic0.app"};class a{constructor(t={}){this.config=n,this.config={...this.config,...t}}async init(){this.client=await i.AuthClient.create(),this.isAuth=await this.client.isAuthenticated(),this.identity=this.client.getIdentity(),this.principal=this.identity?.getPrincipal()}async setData(){if(!this.client)throw Error("init must be called before this method");try{this.isAuth=await this.client.isAuthenticated(),this.identity=this.client.getIdentity(),this.principal=this.identity?.getPrincipal()}catch(t){throw t}}connect(){if(!this.client)throw Error("init must be called before this method");return new Promise((t,e)=>{this.client.login({identityProvider:this.config.providerUrl,onSuccess:async()=>{await this.setData(),t()},onError:e})})}async disconnect(){if(!this.client)throw Error("init must be called before this method");try{await this.client.logout(),await this.setData()}catch(t){throw t}}isAuthenticated(){if(!this.client)throw Error("init must be called before this method");return this.isAuth}getIdentity(){if(!this.client)throw Error("init must be called before this method");return this.identity}getPrincipal(){if(!this.client)throw Error("init must be called before this method");return this.principal}}},3051:(t,e,r)=>{"use strict";r.d(e,{b:()=>a,m:()=>n});var i=r(997);let n=(0,r(6689).createContext)({}),a=({children:t,client:e})=>i.jsx(n.Provider,{value:{client:e},children:t})},3359:(t,e,r)=>{"use strict";r.d(e,{Lm:()=>a,aC:()=>o});var i=r(3051),n=r(6689);let a=t=>{let{client:e}=(0,n.useContext)(i.m),r=e.getActor(t);if(!r)throw Error("This actor doesn't exist");return r},c=()=>{let{client:t}=(0,n.useContext)(i.m);return t},s=()=>{let{client:t}=(0,n.useContext)(i.m);return t.getProviders()},o=()=>{let t=c(),e=s()["internet-identity"];return{connect:async function(){try{await e.connect();let r=e.getIdentity();t.setIdentity(r)}catch(t){throw t}},disconnect:function(){return t.setIdentity(),e.disconnect()},isAuthenticated:function(){return e.isAuthenticated()},getIdentity:function(){return e.getIdentity()},getPrincipal:function(){return e.getPrincipal()}}}},9724:()=>{},4515:t=>{"use strict";t.exports=require("@dfinity/agent")},5088:t=>{"use strict";t.exports=require("@dfinity/auth-client")},6689:t=>{"use strict";t.exports=require("react")},997:t=>{"use strict";t.exports=require("react/jsx-runtime")},9926:t=>{"use strict";t.exports=import("zod")}};var e=require("../webpack-runtime.js");e.C(t);var r=e(e.s=4619);module.exports=r})();